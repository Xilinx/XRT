

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Memory-to-Memory (M2M) Support &mdash; Xilinx Runtime 2019.1 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="Xilinx Runtime 2019.1 documentation" href="index.html"/>
        <link rel="next" title="XRT/Board Debug FAQ" href="debug-faq.html"/>
        <link rel="prev" title="PCIe Peer-to-Peer Support" href="p2p.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> Xilinx Runtime
          

          
          </a>

          
            
            
              <div class="version">
                2019.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Table of Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="platforms.html">Platform Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="execution-model.html">Execution Model Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="xrt.main.html">Xilinx Runtime (XRT) Core Library</a></li>
<li class="toctree-l1"><a class="reference internal" href="mgmt-ioctl.main.html">XCLMGMT (PCIe Management Physical Function) Driver Interfaces</a></li>
<li class="toctree-l1"><a class="reference internal" href="xocl_ioctl.main.html">XOCL (PCIe User Physical Function) Driver Interfaces</a></li>
<li class="toctree-l1"><a class="reference internal" href="sysfs.html">Linux Sys FileSystem Nodes</a></li>
<li class="toctree-l1"><a class="reference internal" href="tools.html">Board Tools and Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="xclbintools.html">Xclbin Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="ert.main.html">Embedded Runtime Library</a></li>
<li class="toctree-l1"><a class="reference internal" href="multiprocess.html">Multi-Process Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="formats.html">Binary Formats</a></li>
<li class="toctree-l1"><a class="reference internal" href="system_requirements.html">System Requirements</a></li>
<li class="toctree-l1"><a class="reference internal" href="build.html">Building and Installing Software Stack</a></li>
<li class="toctree-l1"><a class="reference internal" href="yocto.html">Yocto Recipes For Embedded Flow</a></li>
<li class="toctree-l1"><a class="reference internal" href="test.html">XRT Developer Build and Test Instructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="newdsa-bringup.html">New DSA Bringup</a></li>
<li class="toctree-l1"><a class="reference internal" href="create_platforms.html">Create MPSoC Based Embedded Platforms</a></li>
<li class="toctree-l1"><a class="reference internal" href="p2p.html">PCIe Peer-to-Peer Support</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Memory-to-Memory (M2M) Support</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#example-scenario">Example scenario</a></li>
<li class="toctree-l2"><a class="reference internal" href="#some-limitations">Some limitations:</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="debug-faq.html">XRT/Board Debug FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="xma.main.html">Xilinx Media Accelerator (XMA) Core Library</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Xilinx Runtime</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Memory-to-Memory (M2M) Support</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/m2m.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="memory-to-memory-m2m-support">
<h1>Memory-to-Memory (M2M) Support<a class="headerlink" href="#memory-to-memory-m2m-support" title="Permalink to this headline">¶</a></h1>
<p>Some of the recent Alveo cards support direct Memory to Memory (M2M) data transfer on the card, improving the data transfer performance
as data does not need to be transferred via host while moving from one DDR bank to another.</p>
<div class="section" id="example-scenario">
<h2>Example scenario<a class="headerlink" href="#example-scenario" title="Permalink to this headline">¶</a></h2>
<p>Assume there are two kernels in the XCLBIN, K1 and K2.</p>
<p>K1 interacts with DDR0 due to location proximity on the FPGA.</p>
<p>Similarly, K2 interacts with DDR1 due to location proximity on the FPGA.</p>
<p>The output of the K1 is consumed by K2 for its input. So there has to be data transfer from DDR bank0 to DDR bank1.</p>
<div align="center" class="align-center"><img alt="_images/M2M-transfer.svg" src="_images/M2M-transfer.svg" /></div>
<p>In OpenCL host code, let’s assume four buffers: Buf1, Buf2, Buf3, Buf4.</p>
<dl class="docutils">
<dt>So the data transfer from the host follow the order</dt>
<dd>Buf1 -&gt; K1 -&gt; Buf2 -&gt; Buf3 -&gt; K2 -&gt; Buf4</dd>
</dl>
<p>We can perform a copy from Buf2 to Buf3 using standard OpenCL API <code class="docutils literal"><span class="pre">clEnqueueCopyBuffer</span></code>. See below a code segment.</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>clEnqueueTask(queue, K1 ,0,nullptr,&amp;events1);
clEnqueueCopyBuffer(queue, Buf2,Buf3,0,0,Buffer_size, 1, &amp;event1, &amp;event2);
clEnqueueTask(queue,K2,1,&amp;event2,nullptr);
</pre></div>
</div>
</div>
<div class="section" id="some-limitations">
<h2>Some limitations:<a class="headerlink" href="#some-limitations" title="Permalink to this headline">¶</a></h2>
<ol class="arabic simple">
<li>Hardware supports M2M between two DDR banks, not other memory types such as HBM or PLRAM</li>
<li>The data being copied has to be 64 bit aligned. Otherwise, XRT will do copy via host using the same API</li>
<li>Not all the cards are M2M capable, in that case, XRT will do copy via host using the same API</li>
<li>M2M copy of OpenCL sub-buffers is not properly supported</li>
</ol>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="debug-faq.html" class="btn btn-neutral float-right" title="XRT/Board Debug FAQ" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="p2p.html" class="btn btn-neutral" title="PCIe Peer-to-Peer Support" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017-2019, Xilinx, Inc.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'2019.1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>