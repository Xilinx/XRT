include_directories(
  ${CMAKE_CURRENT_SOURCE_DIR}
  ${XRT_SRC_DIR}/include/1_2
  )

set(XRT_XDP_APPDEBUG_DIR   "${CMAKE_CURRENT_SOURCE_DIR}/appdebug")
set(XRT_XDP_DEBUG_DIR      "${CMAKE_CURRENT_SOURCE_DIR}/debug")
set(XRT_XDP_PROFILE_DIR    "${CMAKE_CURRENT_SOURCE_DIR}/profile")
set(XRT_XDP_PROFILE_DEVICE_DIR    "${CMAKE_CURRENT_SOURCE_DIR}/profile/profile_device")

file(GLOB XRT_XDP_APPDEBUG_FILES
  "${XRT_XDP_APPDEBUG_DIR}/*.h"
  "${XRT_XDP_APPDEBUG_DIR}/*.cpp"
  )
set_source_files_properties (${XRT_XDP_APPDEBUG_FILES} PROPERTIES COMPILE_FLAGS -g)

file(GLOB XRT_XDP_DEBUG_FILES
  "${XRT_XDP_DEBUG_DIR}/*.h"
  "${XRT_XDP_DEBUG_DIR}/*.cpp"
  )

file(GLOB XRT_XDP_PROFILE_FILES
  "${XRT_XDP_PROFILE_DIR}/*.h"
  "${XRT_XDP_PROFILE_DIR}/*.cpp"
  )

file(GLOB XRT_XDP_FILES
  "${CMAKE_CURRENT_SOURCE_DIR}/*.h"
  "${CMAKE_CURRENT_SOURCE_DIR}/*.cpp"
  )

file(GLOB XRT_XDP_PROFILE_DEVICE_FILES
	"${XRT_XDP_PROFILE_DEVICE_DIR}/*.h"
	"${XRT_XDP_PROFILE_DEVICE_DIR}/*.cpp"
  )
#source_group(XRT_XDP_APPDEBUG_FILES FILES ${XRT_XDP_APPDEBUG_FILES})
#source_group(XRT_XDP_DEBUG_FILES FILES ${XRT_XDP_DEBUG_FILES})
#source_group(XRT_XDP_PROFILE_FILES FILES ${XRT_XDP_PROFILE_FILES})

set(XRT_XDP_ALL_SRC
  ${XRT_XDP_APPDEBUG_FILES}
  ${XRT_XDP_DEBUG_FILES}
  ${XRT_XDP_PROFILE_FILES}
  ${XRT_XDP_FILES}
  )

add_library(xdpobj OBJECT ${XRT_XDP_ALL_SRC})
add_library(xdp SHARED ${XRT_XDP_PROFILE_DEVICE_FILES})
add_dependencies(xdp xrt_core)
target_link_libraries (xdp xrt_core)

install (TARGETS xdp LIBRARY DESTINATION ${XRT_INSTALL_DIR}/lib)

install (FILES "${XRT_XDP_PROFILE_DEVICE_DIR}/xperf.h" DESTINATION ${XRT_INSTALL_DIR}/include)

set (APPDEBUG_INSTALL_PREFIX "/opt/xilinx/xrt/share/appdebug")
install (FILES
  ${XRT_XDP_APPDEBUG_DIR}/appdebug.py
  ${XRT_XDP_APPDEBUG_DIR}/appdebugint.py
  DESTINATION ${APPDEBUG_INSTALL_PREFIX}
)
